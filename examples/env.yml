name: matmul-benchmark
channels:
  - defaults
  - conda-forge

dependencies:
  - python=3.10
  - numpy
  - cudatoolkit=11.7         # pick the CUDA version that matches your driver
  - pip

  - pip:
    # PyTorch with CUDA support (adjust version+cuXY to your setup)
    - torch==2.1.0+cu117     \
      --extra-index-url https://download.pytorch.org/whl/cu117
    - torchvision==0.16.0+cu117 \
      --extra-index-url https://download.pytorch.org/whl/cu117
    - torchaudio==2.1.0        \
      --extra-index-url https://download.pytorch.org/whl/cu117

    # CuPy with matching CUDA toolkit
    - cupy-cuda117

