<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>wptherml.materials &mdash; wptherml  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            wptherml
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quickstart Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">wptherml</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">wptherml.materials</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for wptherml.materials</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">InterpolatedUnivariateSpline</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">constants</span>

<span class="n">path_and_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">path_and_file</span><span class="p">[:</span><span class="o">-</span><span class="mi">12</span><span class="p">]</span>


<div class="viewcode-block" id="Materials">
<a class="viewcode-back" href="../../autosummary/wptherml.Materials.html#wptherml.Materials">[docs]</a>
<span class="k">class</span> <span class="nc">Materials</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the absorption, scattering, and extinction spectra of a sphere using Mie theory&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_create_test_multilayer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">central_wavelength</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Simple method to create a 3-entry array of wavelengths as follows:</span>
<span class="sd">        [central_wavelength-1e-9 m, central_wavelength m, central_wavelength+1e-9 m]</span>
<span class="sd">        and dummy _refractive_index_array that can be filled in</span>
<span class="sd">        with actual materials at the wavelength arrays.</span>
<span class="sd">        This is simply meant to enable unit testing for desired wavelengths of the</span>
<span class="sd">        various materials methods</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="n">central_wavelength</span> <span class="o">-</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">central_wavelength</span><span class="p">,</span> <span class="n">central_wavelength</span> <span class="o">+</span> <span class="mf">1e-9</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_wavelengths</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_wavelengths</span><span class="p">),</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_wavelengths</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_find_unique_ri_file_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wl_array</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A simple method to eliminate redundant or numerically indistinguishable</span>
<span class="sd">        data from refractive index files.</span>

<span class="sd">        Arguments</span>
<span class="sd">        ---------</span>
<span class="sd">            wl_array : numpy array of floats</span>
<span class="sd">                the array of wavelengths read from a refractive index file</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            unique_index_array : array of ints</span>
<span class="sd">                the array of the indices of the unique elements of the</span>
<span class="sd">                refractive index file</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">wl_val</span> <span class="o">=</span> <span class="n">wl_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">unique_index_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">wl_array</span><span class="p">)):</span>
            <span class="n">new_wl_val</span> <span class="o">=</span> <span class="n">wl_array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="c1"># skip over redundant values</span>
            <span class="k">if</span> <span class="n">new_wl_val</span> <span class="o">&lt;=</span> <span class="n">wl_val</span><span class="p">:</span>
                <span class="n">wl_val</span> <span class="o">=</span> <span class="n">new_wl_val</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">unique_index_array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">wl_val</span> <span class="o">=</span> <span class="n">new_wl_val</span>

        <span class="k">return</span> <span class="n">unique_index_array</span>

    <span class="k">def</span> <span class="nf">material_H2O</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;defines the refractive index layer of layer_number to be water</span>
<span class="sd">        assuming static refractive index of n = 1.33 + 0j</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.33</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">insert_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;insert an air layer between layer_number-1 and layer_number</span>
<span class="sd">        e.g. if you have a structure that is Air/SiO2/HfO2/Ag/Air</span>
<span class="sd">        and you issue insert_layer(1), the new structure will be</span>
<span class="sd">        Air/Air/SiO2/HfO2/Ag/Air</span>
<span class="sd">        if you issue insert_layer(2), the new structure will be</span>
<span class="sd">        Air/SiO2/Air/HfO2/Ag/Air</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_nwl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">_nl</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
        <span class="n">_temp_ri_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">)</span>
        <span class="n">_new_ri_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">_nwl</span><span class="p">,</span> <span class="n">_nl</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
        <span class="n">_new_air_layer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">_nwl</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span>
        <span class="n">_new_ri_array</span><span class="p">[:,</span> <span class="p">:</span><span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">_temp_ri_array</span><span class="p">[:,</span> <span class="p">:</span><span class="n">layer_number</span><span class="p">]</span>
        <span class="n">_new_ri_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">_new_air_layer</span>
        <span class="n">_new_ri_array</span><span class="p">[:,</span> <span class="n">layer_number</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">_temp_ri_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_new_ri_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_Air</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;defines the refractive index layer of layer_number to be air</span>
<span class="sd">        assuming static refractive index of n = 1.0 + 0j</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_from_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be</span>
<span class="sd">               from a text file with name &quot;file_name&quot; where the text file is ordered:</span>
<span class="sd">               column 1: wavelength in meters, increasing order</span>
<span class="sd">               column 2: real part of refractive index corresponding to wavelengths in col 1</span>
<span class="sd">               column 3: imaginary part of refractive index corresponding to wavelengths in col 1</span>
<span class="sd">               the file is expected to be in the directory $wpthermldir/wptherml/data</span>
<span class="sd">               where $wpthermldir is the full path to the directory where you have wptherml installed</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">                specifies the layer of the stack that will be modelled as SiO2</span>

<span class="sd">            file_name : str</span>
<span class="sd">                the full file-name of the data file containing your refractive index information</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_from_file(1, &quot;SiO2_ir.txt&quot;) -&gt; layer 1 will be SiO2 from the SiO2_ir</span>
<span class="sd">            data set good from visible to 50 microns (0.21-50)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># get path to the sio2 data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/&quot;</span> <span class="o">+</span> <span class="n">file_name</span>
            <span class="c1"># now read SiO2 data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="c1"># now read Ag data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>

            <span class="c1"># sometimes there are duplicate wavelength, n, and k entries</span>
            <span class="c1"># in a data set; we want only the unique elements</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_unique_ri_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>

            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_2D_HOIP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be 2D hybrid organic-inorganic</span>
<span class="sd">               perovskites</span>

<span class="sd">            Reference</span>
<span class="sd">            ---------</span>
<span class="sd">            Song et al. &quot;Determination of dielectric functions and exciton oscillator</span>
<span class="sd">            strength of two-dimensional hybrid perovskites&quot;, ACS Materials Lett. 2021, 3, 1, 148-159</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as SiO2</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># get path to the sio2 data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/2D_HOIP.txt&quot;</span>
            <span class="c1"># now read SiO2 data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_SiO2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be SiO2</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as SiO2</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_SiO2(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be SiO2 from the SiO2_ir</span>
<span class="sd">            data set good from visible to 50 microns (0.21-50)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># get path to the sio2 data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/SiO2_ir.txt&quot;</span>
            <span class="c1"># now read SiO2 data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_TiO2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be TiO2</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as TiO2</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_TiO2(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be TiO2 from the Siefke data set good from visible to 125.123 microns (0.12-125.123)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># get path to the TiO2 data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/TiO2_Siefke.txt&quot;</span>
            <span class="c1"># now read TiO2 data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_Ta2O5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">,</span> <span class="n">wavelength_range</span><span class="o">=</span><span class="s2">&quot;visible&quot;</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be Ta2O5</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as Ta2O5</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_Ta2O5(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be Ta2O5 from the Rodriguez data set good from visible to 1.5 microns (0.02-1.5)</span>
<span class="sd">            &gt;&gt;&gt; material_Ta2O5(2, wavelength_range=&quot;ir&quot;) -&gt; layer 2 will be Ta2O5 from the Bright data set good until 1000 microns (0.5-1000)</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># dictionary specific to Ta2O5 with wavelength range information corresponding to different</span>
            <span class="c1"># data sets</span>
            <span class="n">data1</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;data/Ta2O5_Rodriguez.txt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lower_wavelength&quot;</span><span class="p">:</span> <span class="mf">2.9494e-08</span><span class="p">,</span>
                <span class="s2">&quot;upper_wavelength&quot;</span><span class="p">:</span> <span class="mf">1.5143e-06</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">data2</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;data/Ta2O5_Bright.txt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lower_wavelength&quot;</span><span class="p">:</span> <span class="mf">5.0000e-07</span><span class="p">,</span>
                <span class="s2">&quot;upper_wavelength&quot;</span><span class="p">:</span> <span class="mf">1.0000e-03</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="n">shortest_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">longest_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_wavelengths</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">shortest_wavelength</span> <span class="o">&gt;=</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;lower_wavelength&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">longest_wavelength</span> <span class="o">&lt;=</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;upper_wavelength&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">shortest_wavelength</span> <span class="o">&gt;=</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;lower_wavelength&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">longest_wavelength</span> <span class="o">&lt;=</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;upper_wavelength&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">override</span> <span class="o">==</span> <span class="s2">&quot;false&quot;</span><span class="p">:</span>
                <span class="c1"># make sure the wavelength_range string is all  lowercase</span>
                <span class="n">wavelength_range</span> <span class="o">=</span> <span class="n">wavelength_range</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;visible&quot;</span>
                    <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;short&quot;</span>
                    <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;vis&quot;</span>
                <span class="p">):</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Ta2O5_Rodriguez.txt&quot;</span>

                <span class="k">elif</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;ir&quot;</span> <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;long&quot;</span><span class="p">:</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Ta2O5_Bright.txt&quot;</span>

            <span class="c1"># now read Ta2O5 data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_TiN</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be Tin</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as Tin</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_Tin(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be Tin from the Tin_ellipsometry data set good from visible to 7 microns (0.4-7)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># get path to the tin data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/TiN_ellipsometry_data.txt&quot;</span>
            <span class="c1"># now read Tin data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_static_refractive_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">,</span> <span class="n">refractive_index</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span> <span class="o">*</span> <span class="n">refractive_index</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_Al</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be Al</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as Al</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_Al(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be Al from the Al_Rakic data set good from visible to 200 microns (0.00012399-200)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># get path to the Al data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Al_Rakic.txt&quot;</span>
            <span class="c1"># now read Al data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_Pt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be Pt</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as Pt</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_Pt(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be Pt from the Pt_Rakic data set good from visible to 12.398 microns (0.24797-12.398)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.4</span>
            <span class="p">)</span>
            <span class="c1"># get path to the Platinum data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Pt_Rakic.txt&quot;</span>
            <span class="c1"># now read Platinum data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_HfO2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be HfO2</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as HfO2</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_HfO2(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be HfO2 from the HfO2_Al-Kuhaili data set good from visible to 2 microns (0.2-2)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.4</span>
            <span class="p">)</span>
            <span class="c1"># get path to the HfO2 data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/HfO2_Al-Kuhaili.txt&quot;</span>

            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_Au</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">,</span> <span class="n">wavelength_range</span><span class="o">=</span><span class="s2">&quot;visible&quot;</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be Au</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as Au</span>
<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_Au(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be Au from the JC_RI_f data set  from 0.2 to 1.000025 microns</span>
<span class="sd">            &gt;&gt;&gt; material_Au(2, wavelength_range=&quot;ir&quot;) -&gt; layer 2 will be Au from the Au_IR data set from 0.3 to 24.93 microns</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># dictionary specific to Au with wavelength range information corresponding to different</span>
            <span class="c1"># data sets</span>
            <span class="n">data1</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;data/Au_JC_RI_f.txt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lower_wavelength&quot;</span><span class="p">:</span> <span class="mf">2e-07</span><span class="p">,</span>
                <span class="s2">&quot;upper_wavelength&quot;</span><span class="p">:</span> <span class="mf">1.00025e-06</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">data2</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;data/Au_IR.txt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lower_wavelength&quot;</span><span class="p">:</span> <span class="mf">3.000000e-07</span><span class="p">,</span>
                <span class="s2">&quot;upper_wavelength&quot;</span><span class="p">:</span> <span class="mf">2.493000e-05</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="n">shortest_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">longest_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_wavelengths</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">shortest_wavelength</span> <span class="o">&gt;=</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;lower_wavelength&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">longest_wavelength</span> <span class="o">&lt;=</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;upper_wavelength&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">shortest_wavelength</span> <span class="o">&gt;=</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;lower_wavelength&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">longest_wavelength</span> <span class="o">&lt;=</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;upper_wavelength&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">override</span> <span class="o">==</span> <span class="s2">&quot;false&quot;</span><span class="p">:</span>
                <span class="c1"># make sure the wavelength_range string is all  lowercase</span>
                <span class="n">wavelength_range</span> <span class="o">=</span> <span class="n">wavelength_range</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;visible&quot;</span>
                    <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;short&quot;</span>
                    <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;vis&quot;</span>
                <span class="p">):</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Au_JC_RI_f.txt.txt&quot;</span>

                <span class="k">elif</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;ir&quot;</span> <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;long&quot;</span><span class="p">:</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Au_IR.txt&quot;</span>

            <span class="c1"># now read Au data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_Rh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be Rh</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as Rh</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_Rh(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be Rh from the Rh_Weaver data set good from visible to 12.4 microns (0.2-12.4)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.4</span>
            <span class="p">)</span>
            <span class="c1"># get path to the Rh data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Rh_Weaver.txt&quot;</span>
            <span class="c1"># now read Rh data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_Al2O3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be Al2O3</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as Al2O3</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_Al2O3(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be Al2O3 from the Al2O3_ri.txt data set good from visible to 2.5 microns (0.4-2.5)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.4</span>
            <span class="p">)</span>
            <span class="c1"># get path to the Al2O3 data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Al2O3_ri.txt&quot;</span>
            <span class="c1"># now read Au data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_Ru</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be Ru</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as Ru</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_Ru(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be Ru from the Ru.txt data set good from visible to 6.0 microns (0.4-6.0)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.4</span>
            <span class="p">)</span>
            <span class="c1"># get path to the Ru data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Ru.txt&quot;</span>
            <span class="c1"># now read Ru data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_polystyrene</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be polystyrene</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as polystyrene</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_polystyrene(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be polystyrene from the polystyrene.txt data set good from visible to 19.942 microns (0.4-19.942)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span> <span class="o">*</span> <span class="mf">2.4</span>
            <span class="p">)</span>
            <span class="c1"># get path to the polystyrene data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Polystyrene.txt&quot;</span>
            <span class="c1"># now read Au data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_AlN</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">,</span> <span class="n">wavelength_range</span><span class="o">=</span><span class="s2">&quot;visible&quot;</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be AlN</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as AlN</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_AlN(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be AlN from the AlN_Pastrnak data set from 0.22 to 5.0 microns</span>
<span class="sd">            &gt;&gt;&gt; material_AlN(2, wavelength_range=&quot;ir&quot;) -&gt; layer 2 will be AlN from the AlN_Kischkat data set from 1.53846 to 14.2857 microns</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># dictionary specific to AlN with wavelength range information corresponding to different</span>
            <span class="c1"># data sets</span>
            <span class="n">data1</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;data/AlN_Pastrnak.txt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lower_wavelength&quot;</span><span class="p">:</span> <span class="mf">0.22e-6</span><span class="p">,</span>
                <span class="s2">&quot;upper_wavelength&quot;</span><span class="p">:</span> <span class="mf">5.00e-6</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">data2</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;data/AlN_Kischkat.txt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lower_wavelength&quot;</span><span class="p">:</span> <span class="mf">1.53846e-06</span><span class="p">,</span>
                <span class="s2">&quot;upper_wavelength&quot;</span><span class="p">:</span> <span class="mf">14.2857e-06</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="n">shortest_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">longest_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_wavelengths</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">shortest_wavelength</span> <span class="o">&gt;=</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;lower_wavelength&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">longest_wavelength</span> <span class="o">&lt;=</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;upper_wavelength&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">shortest_wavelength</span> <span class="o">&gt;=</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;lower_wavelength&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">longest_wavelength</span> <span class="o">&lt;=</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;upper_wavelength&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">override</span> <span class="o">==</span> <span class="s2">&quot;false&quot;</span><span class="p">:</span>
                <span class="c1"># make sure the wavelength_range string is all  lowercase</span>
                <span class="n">wavelength_range</span> <span class="o">=</span> <span class="n">wavelength_range</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;visible&quot;</span>
                    <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;short&quot;</span>
                    <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;vis&quot;</span>
                <span class="p">):</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/AlN_Pastrnak.txt&quot;</span>

                <span class="k">elif</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;ir&quot;</span> <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;long&quot;</span><span class="p">:</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/AlN_Kischkat.txt&quot;</span>

            <span class="c1"># now read AlN data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_W</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">,</span> <span class="n">wavelength_range</span><span class="o">=</span><span class="s2">&quot;visible&quot;</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be W</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as W</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_W(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be W from the W_Rakic data set good from visible to 12.398 microns (0.24797-12.398)</span>
<span class="sd">            &gt;&gt;&gt; material_W(2, wavelength_range=&quot;ir&quot;) -&gt; layer 2 will be W from the Ordal data set good until 200 microns (0.667-200)</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># dictionary specific to W with wavelength range information corresponding to different</span>
            <span class="c1"># data sets</span>
            <span class="n">data1</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;data/W_Rakic.txt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lower_wavelength&quot;</span><span class="p">:</span> <span class="mf">2.4797e-07</span><span class="p">,</span>
                <span class="s2">&quot;upper_wavelength&quot;</span><span class="p">:</span> <span class="mf">1.2398e-05</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">data2</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;data/W_Ordal.txt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lower_wavelength&quot;</span><span class="p">:</span> <span class="mf">6.67000e-07</span><span class="p">,</span>
                <span class="s2">&quot;upper_wavelength&quot;</span><span class="p">:</span> <span class="mf">2.00000e-04</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="n">shortest_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">longest_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_wavelengths</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">shortest_wavelength</span> <span class="o">&gt;=</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;lower_wavelength&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">longest_wavelength</span> <span class="o">&lt;=</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;upper_wavelength&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">shortest_wavelength</span> <span class="o">&gt;=</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;lower_wavelength&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">longest_wavelength</span> <span class="o">&lt;=</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;upper_wavelength&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">override</span> <span class="o">==</span> <span class="s2">&quot;false&quot;</span><span class="p">:</span>
                <span class="c1"># make sure the wavelength_range string is all  lowercase</span>
                <span class="n">wavelength_range</span> <span class="o">=</span> <span class="n">wavelength_range</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;visible&quot;</span>
                    <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;short&quot;</span>
                    <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;vis&quot;</span>
                <span class="p">):</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/W_Rakic.txt&quot;</span>

                <span class="k">elif</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;ir&quot;</span> <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;long&quot;</span><span class="p">:</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/W_Ordal.txt&quot;</span>

            <span class="c1"># now read W data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_Si</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">,</span> <span class="n">wavelength_range</span><span class="o">=</span><span class="s2">&quot;visible&quot;</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be Si</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as Si</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_si(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be Si from the Schinke data set good from visible to 1.5 microns (0.25-1.45)</span>
<span class="sd">            &gt;&gt;&gt; material_si(2, wavelength_range=&quot;ir&quot;) -&gt; layer 2 will be Si from the Shkondin data set good until 1000 microns (2-20)</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># dictionary specific to W with wavelength range information corresponding to different</span>
            <span class="c1"># data sets</span>
            <span class="n">data1</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;data/Si_Schinke.txt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lower_wavelength&quot;</span><span class="p">:</span> <span class="mf">0.000000250</span><span class="p">,</span>
                <span class="s2">&quot;upper_wavelength&quot;</span><span class="p">:</span> <span class="mf">0.000001450</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">data2</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;data/Si_Shkondin.txt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lower_wavelength&quot;</span><span class="p">:</span> <span class="mf">0.00000200000</span><span class="p">,</span>
                <span class="s2">&quot;upper_wavelength&quot;</span><span class="p">:</span> <span class="mf">0.00002000000</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="n">shortest_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">longest_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_wavelengths</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">shortest_wavelength</span> <span class="o">&gt;=</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;lower_wavelength&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">longest_wavelength</span> <span class="o">&lt;=</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;upper_wavelength&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">shortest_wavelength</span> <span class="o">&gt;=</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;lower_wavelength&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">longest_wavelength</span> <span class="o">&lt;=</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;upper_wavelength&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">override</span> <span class="o">==</span> <span class="s2">&quot;false&quot;</span><span class="p">:</span>
                <span class="c1"># make sure the wavelength_range string is all  lowercase</span>
                <span class="n">wavelength_range</span> <span class="o">=</span> <span class="n">wavelength_range</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;visible&quot;</span>
                    <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;short&quot;</span>
                    <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;vis&quot;</span>
                <span class="p">):</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Si_Schinke.txt&quot;</span>

                <span class="k">elif</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;ir&quot;</span> <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;long&quot;</span><span class="p">:</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Si_Shkondin.txt&quot;</span>

            <span class="c1"># now read Si data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_Si3N4</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be Si3N4</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as Si3N4</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_Si3N4(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be Si3N4 from the Si3N4_Luke.txt data set good from visible to 5 microns (0.361-5.14)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># get path to the Si3N4 data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Si3N4_Luke.txt&quot;</span>
            <span class="c1"># now read Tin data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_ZrO2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be ZrO2</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as ZrO2</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_ZrO2(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be ZrO2 from the ZrO2_Wood.txt data set good from visible to 5.5 microns (0.31-5.504)</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># get path to the Zr02 data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/ZrO2_Wood.txt&quot;</span>
            <span class="c1"># now read Tin data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_SiO2_UDM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be SiO2 using a universal dispersion model (UDM)</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as SiO2 udm</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_SiO2_UDM(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be SiO2 from the UDM data set good from 0.01 to 100 eV</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># get path to the Si02 data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/SiO2_udm.txt&quot;</span>
            <span class="c1"># now read Tin data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">e_data</span> <span class="o">=</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">wl_nm</span> <span class="o">=</span> <span class="mf">1239.84193</span> <span class="o">/</span> <span class="n">e_data</span>

            <span class="n">wl_si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">wl_nm</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span>

            <span class="n">n_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">file_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">k_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">file_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>

            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">wl_si</span><span class="p">,</span> <span class="n">n_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">wl_si</span><span class="p">,</span> <span class="n">k_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_SiO2_UDM_v2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be SiO2 using the universal dispersion model (UDM) here: http://newad.physics.muni.cz/table-udm/LithosilQ2-SPIE9890.Enk </span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as SiO2 udm</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_SiO2_UDM_v2(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be SiO2 from the UDM data set good from 0.01 to 100 eV</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># get path to the Si02 data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/SiO2_udm_v2.txt&quot;</span>
            <span class="c1"># now read Tin data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">e_data</span> <span class="o">=</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">wl_nm</span> <span class="o">=</span> <span class="mf">1239.84193</span> <span class="o">/</span> <span class="n">e_data</span>

            <span class="n">wl_si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">wl_nm</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span>

            <span class="n">n_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">file_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">k_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">file_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>

            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">wl_si</span><span class="p">,</span> <span class="n">n_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">wl_si</span><span class="p">,</span> <span class="n">k_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_HfO2_UDM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be HfO2 using the universal dispersion model (UDM) here: http://newad.physics.muni.cz/table-udm/HfO2-X2194-AO54_9108.Enk</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as HfO2 udm</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_HfO2_UDM(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be HfO2 from the UDM data set good from 0.01 to 100 eV</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># get path to the Si02 data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/HfO2_udm.txt&quot;</span>
            <span class="c1"># now read Tin data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">e_data</span> <span class="o">=</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">wl_nm</span> <span class="o">=</span> <span class="mf">1239.84193</span> <span class="o">/</span> <span class="n">e_data</span>

            <span class="n">wl_si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">wl_nm</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span>

            <span class="n">n_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">file_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">k_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">file_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>

            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">wl_si</span><span class="p">,</span> <span class="n">n_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">wl_si</span><span class="p">,</span> <span class="n">k_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_HfO2_UDM_v2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be HfO2 using the universal dispersion model (UDM) here: http://newad.physics.muni.cz/table-udm/HfO2-X2194-AO54_9108.Enk</span>
<span class="sd">               with the modification that the imaginary part of the refractive index is set to zero!</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as HfO2 udm</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_HfO2_UDM(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be &quot;lossless&quot; HfO2 from the UDM data set good from 0.01 to 100 eV</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># get path to the Si02 data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/HfO2_udm_no_loss.txt&quot;</span>
            <span class="c1"># now read Tin data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">e_data</span> <span class="o">=</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">wl_nm</span> <span class="o">=</span> <span class="mf">1239.84193</span> <span class="o">/</span> <span class="n">e_data</span>

            <span class="n">wl_si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">wl_nm</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span>

            <span class="n">n_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">file_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">k_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">file_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>

            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">wl_si</span><span class="p">,</span> <span class="n">n_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">wl_si</span><span class="p">,</span> <span class="n">k_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_MgF2_UDM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be MgF2 using the universal dispersion model (UDM) here: http://newad.physics.muni.cz/table-udm/MgF2-X2935-SPIE9628.Enk</span>
<span class="sd">               </span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as MgF2 udm</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_HfO2_UDM(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be MgF2 from the UDM data set good from 0.01 to 100 eV</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># get path to the Si02 data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/MgF2_udm.txt&quot;</span>
            <span class="c1"># now read Tin data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">e_data</span> <span class="o">=</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">wl_nm</span> <span class="o">=</span> <span class="mf">1239.84193</span> <span class="o">/</span> <span class="n">e_data</span>

            <span class="n">wl_si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">wl_nm</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span>

            <span class="n">n_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">file_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">k_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">file_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>

            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">wl_si</span><span class="p">,</span> <span class="n">n_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">wl_si</span><span class="p">,</span> <span class="n">k_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">material_Al2O3_UDM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be Al203</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as Al203</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_Al2O3_UDM(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be Al2O3 from the UDM data set good from 0.01 to 100 eV</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># get path to the Al203 data file</span>
            <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Al2O3_udm.txt&quot;</span>
            <span class="c1"># now read Tin data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">e_data</span> <span class="o">=</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">wl_nm</span> <span class="o">=</span> <span class="mf">1239.84193</span> <span class="o">/</span> <span class="n">e_data</span>

            <span class="n">wl_si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">wl_nm</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-9</span>

            <span class="n">n_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">file_data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">k_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">file_data</span><span class="p">[:,</span><span class="mi">2</span><span class="p">])</span>

            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">wl_si</span><span class="p">,</span> <span class="n">n_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">wl_si</span><span class="p">,</span> <span class="n">k_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_Re</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">,</span> <span class="n">wavelength_range</span><span class="o">=</span><span class="s2">&quot;visible&quot;</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be Re</span>

<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as Re</span>

<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>

<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>

<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>

<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_Re(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be Re from the Re_Windt data set good from visible to 1.5 microns (0.00236-0.12157)</span>
<span class="sd">            &gt;&gt;&gt; material_Re(2, wavelength_range=&quot;ir&quot;) -&gt; layer 2 will be Re from the Re_Palik data set good until 6 microns (0.4-6)</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># dictionary specific to W with wavelength range information corresponding to different</span>
            <span class="c1"># data sets</span>
            <span class="n">data1</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;data/Re_Windt.txt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lower_wavelength&quot;</span><span class="p">:</span> <span class="mf">2.36e-09</span><span class="p">,</span>
                <span class="s2">&quot;upper_wavelength&quot;</span><span class="p">:</span> <span class="mf">1.2157e-07</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">data2</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;data/Re_Palik.txt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lower_wavelength&quot;</span><span class="p">:</span> <span class="mf">0.0000004000</span><span class="p">,</span>
                <span class="s2">&quot;upper_wavelength&quot;</span><span class="p">:</span> <span class="mf">0.0000060000</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="n">shortest_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">longest_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_wavelengths</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">shortest_wavelength</span> <span class="o">&gt;=</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;lower_wavelength&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">longest_wavelength</span> <span class="o">&lt;=</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;upper_wavelength&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">shortest_wavelength</span> <span class="o">&gt;=</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;lower_wavelength&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">longest_wavelength</span> <span class="o">&lt;=</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;upper_wavelength&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">override</span> <span class="o">==</span> <span class="s2">&quot;false&quot;</span><span class="p">:</span>
                <span class="c1"># make sure the wavelength_range string is all  lowercase</span>
                <span class="n">wavelength_range</span> <span class="o">=</span> <span class="n">wavelength_range</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;visible&quot;</span>
                    <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;short&quot;</span>
                    <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;vis&quot;</span>
                <span class="p">):</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Re_Windt.txt&quot;</span>

                <span class="k">elif</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;ir&quot;</span> <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;long&quot;</span><span class="p">:</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Re_Palik.txt&quot;</span>

            <span class="c1"># now read Re data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_Ag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">,</span> <span class="n">wavelength_range</span><span class="o">=</span><span class="s2">&quot;visible&quot;</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be Ag</span>
<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as Ag</span>
<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>
<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>
<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>
<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_Ag(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be Ag from the Ag_JC data set good from 0.1879 to 1.937</span>
<span class="sd">            &gt;&gt;&gt; material_Ag(2, wavelength_range=&quot;ir&quot;) -&gt; layer 2 will be Ag from the Yang data set good until 24.92 microns (0.27-24.92)</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># dictionary specific to W with wavelength range information corresponding to different</span>
            <span class="c1"># data sets</span>
            <span class="n">data1</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;data/Ag_JC.txt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lower_wavelength&quot;</span><span class="p">:</span> <span class="mf">1.87900e-07</span><span class="p">,</span>
                <span class="s2">&quot;upper_wavelength&quot;</span><span class="p">:</span> <span class="mf">1.93700e-06</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">data2</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;data/Ag_Yang.txt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lower_wavelength&quot;</span><span class="p">:</span> <span class="mf">2.70000e-07</span><span class="p">,</span>
                <span class="s2">&quot;upper_wavelength&quot;</span><span class="p">:</span> <span class="mf">2.49200e-05</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="n">shortest_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">longest_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_wavelengths</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">shortest_wavelength</span> <span class="o">&gt;=</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;lower_wavelength&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">longest_wavelength</span> <span class="o">&lt;=</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;upper_wavelength&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">shortest_wavelength</span> <span class="o">&gt;=</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;lower_wavelength&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">longest_wavelength</span> <span class="o">&lt;=</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;upper_wavelength&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">override</span> <span class="o">==</span> <span class="s2">&quot;false&quot;</span><span class="p">:</span>
                <span class="c1"># make sure the wavelength_range string is all  lowercase</span>
                <span class="n">wavelength_range</span> <span class="o">=</span> <span class="n">wavelength_range</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;visible&quot;</span>
                    <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;short&quot;</span>
                    <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;vis&quot;</span>
                <span class="p">):</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Ag_JC.txt&quot;</span>

                <span class="k">elif</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;ir&quot;</span> <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;long&quot;</span><span class="p">:</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Ag_Yang.txt&quot;</span>

            <span class="c1"># now read Ag data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>

            <span class="c1"># sometimes there are duplicate wavelength, n, and k entries</span>
            <span class="c1"># in a data set; we want only the unique elements</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_unique_ri_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>

            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">material_Pb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer_number</span><span class="p">,</span> <span class="n">wavelength_range</span><span class="o">=</span><span class="s2">&quot;visible&quot;</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="s2">&quot;true&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">layer_number</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">layer_number</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_layers</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;defines the refractive index of layer layer_number to be Pb</span>
<span class="sd">            Arguments</span>
<span class="sd">            ----------</span>
<span class="sd">            layer_number : int</span>
<span class="sd">            specifies the layer of the stack that will be modelled as Pb</span>
<span class="sd">            wavelength_range (optional) : str</span>
<span class="sd">            specifies wavelength regime that is desired for modelling the material</span>
<span class="sd">            Attributes</span>
<span class="sd">            ----------</span>
<span class="sd">            _refractive_index_array : 1 x number_of_wavelengths numpy array of complex floats</span>
<span class="sd">            Returns</span>
<span class="sd">            -------</span>
<span class="sd">            None</span>
<span class="sd">            Examples</span>
<span class="sd">            --------</span>
<span class="sd">            &gt;&gt;&gt; material_pb(1, wavelength_range=&quot;visible&quot;) -&gt; layer 1 will be Pb from the Werner data set good from visible to 2.47 microns</span>
<span class="sd">            &gt;&gt;&gt; material_pb(2, wavelength_range=&quot;ir&quot;) -&gt; layer 2 will be Pb from the ordal data set good until 667 microns</span>
<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># dictionary specific to W with wavelength range information corresponding to different</span>
            <span class="c1"># data sets</span>
            <span class="n">data1</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;data/Pb_Werner.txt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lower_wavelength&quot;</span><span class="p">:</span> <span class="mf">1.758600000e-08</span><span class="p">,</span>
                <span class="s2">&quot;upper_wavelength&quot;</span><span class="p">:</span> <span class="mf">2.479684000e-06</span><span class="p">,</span>
            <span class="p">}</span>
            <span class="n">data2</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="s2">&quot;data/Pb_Ordal.txt&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lower_wavelength&quot;</span><span class="p">:</span> <span class="mf">0.00000066700000</span><span class="p">,</span>
                <span class="s2">&quot;upper_wavelength&quot;</span><span class="p">:</span> <span class="mf">0.00066700000000</span><span class="p">,</span>
            <span class="p">}</span>

            <span class="n">shortest_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">longest_wavelength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_wavelengths</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">shortest_wavelength</span> <span class="o">&gt;=</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;lower_wavelength&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">longest_wavelength</span> <span class="o">&lt;=</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;upper_wavelength&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">elif</span> <span class="p">(</span>
                <span class="n">shortest_wavelength</span> <span class="o">&gt;=</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;lower_wavelength&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">longest_wavelength</span> <span class="o">&lt;=</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;upper_wavelength&quot;</span><span class="p">]</span>
            <span class="p">):</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data2</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">data1</span><span class="p">[</span><span class="s2">&quot;file&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">override</span> <span class="o">==</span> <span class="s2">&quot;false&quot;</span><span class="p">:</span>
                <span class="c1"># make sure the wavelength_range string is all  lowercase</span>
                <span class="n">wavelength_range</span> <span class="o">=</span> <span class="n">wavelength_range</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;visible&quot;</span>
                    <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;short&quot;</span>
                    <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;vis&quot;</span>
                <span class="p">):</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Pb_Werner.txt&quot;</span>

                <span class="k">elif</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;ir&quot;</span> <span class="ow">or</span> <span class="n">wavelength_range</span> <span class="o">==</span> <span class="s2">&quot;long&quot;</span><span class="p">:</span>
                    <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Pb_Ordal.txt&quot;</span>

            <span class="c1"># now read Pb data into a numpy array</span>
            <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
            <span class="c1"># file_path[:,0] -&gt; wavelengths in meters</span>
            <span class="c1"># file_path[:,1] -&gt; real part of the refractive index</span>
            <span class="c1"># file_path[:,2] -&gt; imaginary part of the refractive index</span>
            <span class="n">n_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
            <span class="n">k_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_refractive_index_array</span><span class="p">[:,</span> <span class="n">layer_number</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_spline</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span>
            <span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">k_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_CIE</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reads CIE data and stores as attributes self.cie_cr, self.cie_cg, self.cie_cb</span>

<span class="sd">        Arguments</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        Equations 29-32 of https://github.com/FoleyLab/wptherml/blob/master/docs/Equations.pdf</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        _cie_cr : 1 x wavelength array of floats</span>
<span class="sd">            data corresponding to red cone response function in integrand of Eq. 29</span>

<span class="sd">        _cie_cg : 1 x wavelength array of floats</span>
<span class="sd">            data corresponding to the green cone response function in integrand of Eq. 30</span>

<span class="sd">        _cie_cb : 1 x wavelength array of floats</span>
<span class="sd">            data corresponding to the blue cone response function in integrand of Eq. 31</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># initialize cie arrays?</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cie_cr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cie_cg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cie_cb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>
        <span class="c1"># )</span>
        <span class="c1"># get path to the cie data</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/cie_cmf.txt&quot;</span>
        <span class="c1"># now read Rh data into a numpy array</span>
        <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="c1"># file_data[:,0] -&gt; wavelengths in nm</span>
        <span class="c1"># file_data[:,1] -&gt; cr response function</span>
        <span class="c1"># file_data[:,2] -&gt; cg response function</span>
        <span class="c1"># file_data[:,3] -&gt; cb resposne function</span>

        <span class="n">_cr_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
            <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="n">_cg_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
            <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="n">_cb_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
            <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e-9</span><span class="p">,</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>
        <span class="c1"># values of data file at 500 nm</span>
        <span class="n">expected_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0049</span><span class="p">,</span> <span class="mf">0.3230</span><span class="p">,</span> <span class="mf">0.2720</span><span class="p">])</span>
        <span class="n">spline_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="n">_cr_spline</span><span class="p">(</span><span class="mf">500e-9</span><span class="p">),</span> <span class="n">_cg_spline</span><span class="p">(</span><span class="mf">500e-9</span><span class="p">),</span> <span class="n">_cb_spline</span><span class="p">(</span><span class="mf">500e-9</span><span class="p">)]</span>
        <span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">expected_values</span><span class="p">,</span> <span class="n">spline_values</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cie_cr</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">_cr_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cie_cg</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">_cg_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cie_cb</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">_cb_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_AM</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reads AM1.5 data and returns an array of the AM1.5 data evaluated at each value of</span>
<span class="sd">            self.wavelength_array</span>

<span class="sd">        Arguments</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        add</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        1 x number_of_wavelengths array of floats</span>
<span class="sd">            Data corresponding the AM1.5 spectrum evaluated at each value of self.wavelength_array</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># get path to the AM data</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/scaled_AM_1_5.txt&quot;</span>
        <span class="c1"># now read Rh data into a numpy array</span>
        <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="c1"># file_data[:,0] -&gt; wavelengths in m</span>
        <span class="c1"># file_data[:,1] -&gt; solar spectrum in W / m / m^2 / sr</span>

        <span class="n">_solar_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
            <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>

        <span class="c1"># values of data file at 615 nm</span>
        <span class="c1"># 0.000000615000000       1325400000.0000000000000000000000</span>
        <span class="n">_expected_value</span> <span class="o">=</span> <span class="mf">1325400000.0</span>
        <span class="n">_spline_value</span> <span class="o">=</span> <span class="n">_solar_spline</span><span class="p">(</span><span class="mf">615e-9</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">_expected_value</span><span class="p">,</span> <span class="n">_spline_value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_solar_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_Atmospheric_Transmissivity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reads atmospherical transmissivity data and returns</span>
<span class="sd">            an array of this data evaluated at each value of self.wavelength_array</span>

<span class="sd">        Arguments</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        add</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        1 x number_of_wavelengths array of floats</span>
<span class="sd">            atmospheric transmissivity evaluated at each value of self.wavelength_array</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># get path to the AM data</span>
        <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;data/Atmospheric_transmissivity.txt&quot;</span>
        <span class="c1"># now read Rh data into a numpy array</span>
        <span class="n">file_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="c1"># file_data[:,0] -&gt; wavelengths in m</span>
        <span class="c1"># file_data[:,1] -&gt; atmospheric transmissivity</span>

        <span class="c1"># get indices of unique elements</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_unique_ri_file_data</span><span class="p">(</span><span class="n">file_data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>

        <span class="n">_atrans_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
            <span class="n">file_data</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">file_data</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>

        <span class="c1"># values of data file at 7.1034e-06 meters (7.1034 microns) -&gt; T = 0.561289</span>
        <span class="n">_expected_value</span> <span class="o">=</span> <span class="mf">0.561289</span>
        <span class="n">_spline_value</span> <span class="o">=</span> <span class="n">_atrans_spline</span><span class="p">(</span><span class="mf">7.1034e-6</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">_expected_value</span><span class="p">,</span> <span class="n">_spline_value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_atrans_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_EQE_spectral_response</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Will compute the spectral response function using tabulated EQE values for user input thickness</span>
<span class="sd">            from </span>

<span class="sd">            &quot;Optical Properties and Modeling of 2D Perovskite Solar Cells&quot;,</span>
<span class="sd">            Bin Liu, Chan Myae Myae Soe, Constantinos C. Stoumpos, Wanyi Nie, Hsinhan Tsai, Kimin</span>
<span class="sd">            Lim, Aditya D. Mohite, Mercouri G. Kanatzidis, Tobin J. Marks, Kenneth D. Singer</span>
<span class="sd">            Advanced Materials, (34), 1. January 6, 2022 </span>
<span class="sd">            https://doi.org/10.1002/adma.202107211</span>

<span class="sd">            on EQE curves of Pb5 perovskite-based devices.</span>

<span class="sd">            Using formula SR = q * EQE * \lambda / (h * c)</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        psc_thickness : </span>
<span class="sd">                        User-input thickness in nm of PSC.</span>
<span class="sd">        _eqe_array :</span>
<span class="sd">                        Table of EQE values extrapolated from graph.</span>
<span class="sd">        _sr_array : </span>
<span class="sd">                        Calculated spectral response based on formula, wavelength, tabulated values, and constants.</span>
<span class="sd">        _eqe_spline :</span>
<span class="sd">                        Spline best fit based on wavelength array and EQE data.</span>
<span class="sd">        _sr_spline :</span>
<span class="sd">                        Spline best fit based on SR array and wavelength array.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Initialize wavelength array and variable for thickness</span>
        <span class="n">_wavelength_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">250</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">350</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">550</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">650</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">750</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">850</span><span class="p">])</span> <span class="o">*</span> <span class="mf">1e-9</span>

        <span class="c1"># Check for psc values</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">psc_thickness_option</span> <span class="o">==</span> <span class="mi">110</span><span class="p">:</span>
            <span class="n">_eqe_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>	<span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">psc_thickness_option</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">_eqe_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">psc_thickness_option</span> <span class="o">==</span> <span class="mi">250</span><span class="p">:</span>
            <span class="n">_eqe_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>	<span class="mi">0</span><span class="p">])</span>
        
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">psc_thickness_option</span> <span class="o">==</span> <span class="mi">410</span><span class="p">:</span>
            <span class="n">_eqe_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
                    
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_eqe_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

        <span class="c1"># Transferring from percentages and SR calculation</span>
        <span class="n">_eqe_array</span> <span class="o">=</span> <span class="n">_eqe_array</span> <span class="o">*</span> <span class="mf">0.01</span>
        <span class="n">_sr_array</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">e</span> <span class="o">*</span> <span class="n">_eqe_array</span> <span class="o">*</span> <span class="n">_wavelength_array</span> <span class="o">/</span> <span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">h</span> <span class="o">*</span> <span class="n">constants</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>

        <span class="c1"># Spline for line of best fit based on current data</span>
        <span class="n">_eqe_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
            <span class="n">_wavelength_array</span><span class="p">,</span> <span class="n">_eqe_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)</span>

        <span class="n">_sr_spline</span> <span class="o">=</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
                <span class="n">_wavelength_array</span><span class="p">,</span> <span class="n">_sr_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span>
            <span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">perovskite_eqe</span> <span class="o">=</span> <span class="n">_eqe_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">perovskite_spectral_response</span> <span class="o">=</span> <span class="n">_sr_spline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wavelength_array</span><span class="p">)</span></div>

    

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Foley Lab. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.5.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>